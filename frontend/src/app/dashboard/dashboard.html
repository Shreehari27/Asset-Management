<div class="dashboard-container">
  <h2 class="dashboard-heading">Dashboard</h2>

  <!-- Summary Cards -->
  <div class="cards">
    <mat-card class="stat-card">
      <div class="stat-title">Total Assets</div>
      <div class="stat-value">{{ totalAssets }}</div>
    </mat-card>
    <mat-card class="stat-card">
      <div class="stat-title">Assigned Assets</div>
      <div class="stat-value">{{ assignedAssets }}</div>
    </mat-card>
    <mat-card class="stat-card">
      <div class="stat-title">Available Assets</div>
      <div class="stat-value">{{ availableAssets }}</div>
    </mat-card>
    <mat-card class="stat-card">
      <div class="stat-title">Scrapped Assets</div>
      <div class="stat-value">{{ scrappedAssets }}</div>
    </mat-card>
    <mat-card class="stat-card">
      <div class="stat-title">Employees</div>
      <div class="stat-value">{{ totalEmployees }}</div>
    </mat-card>
  </div>

  <!-- Asset Type Statistics -->
  <h3 class="section-heading">Asset Type Statistics</h3>
  <div class="cards">
    <mat-card class="stat-card" *ngFor="let type of objectKeys(assetTypeSummary)">
      <div class="stat-title">{{ type }}</div>
      <div class="stat-value">
        <div>Assigned: {{ assetTypeSummary[type].assigned }}</div>
        <div>Available: {{ assetTypeSummary[type].available }}</div>
        <div>Scrapped: {{ assetTypeSummary[type].scrapped }}</div>
        <div *ngIf="assetTypeSummary[type].ready_to_be_assigned !== undefined">
          New: {{ assetTypeSummary[type].ready_to_be_assigned }}
        </div>
      </div>
    </mat-card>
  </div>

  <!-- Cable Type Statistics -->
  <h3 class="section-heading">Cable Type Statistics</h3>
  <div class="cards">
    <mat-card class="stat-card" *ngFor="let type of objectKeys(cableTypeSummary)">
      <div class="stat-title">{{ type }}</div>
      <div class="stat-value">
        <div>Assigned: {{ cableTypeSummary[type].assigned }}</div>
        <div>Available: {{ cableTypeSummary[type].available }}</div>
        <div>Scrapped: {{ cableTypeSummary[type].scrapped }}</div>
        <div *ngIf="cableTypeSummary[type]?.ready_to_be_assigned !== undefined">
          New: {{ cableTypeSummary[type]?.ready_to_be_assigned }}
        </div>
      </div>
    </mat-card>
  </div>

  <!-- Collapsible Report Section -->
  <mat-accordion multi="true" class="report-accordion">

    <!-- Reorder Level Summary -->
    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>ğŸ“¦ Reorder Level Summary</mat-panel-title>
      </mat-expansion-panel-header>

      <div class="cards">
        <mat-card class="stat-card" *ngFor="let item of reorderLevelSummary">
          <div class="stat-title">{{ item.asset_type }}</div>
          <div class="stat-value">
            <div>Available: {{ item.available }}</div>
            <div>New: {{ item.ready_to_be_assigned }}</div>
            <div>Total in Hand: {{ item.total_in_hand }}</div>
          </div>
        </mat-card>
      </div>
    </mat-expansion-panel>

    <!--  Inventory Summary -->
    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>ğŸ§¾ Inventory Summary</mat-panel-title>
      </mat-expansion-panel-header>

      <div class="cards">
        <mat-card class="stat-card" *ngFor="let lot of lotStatistics">
          <div class="stat-title">Lot: {{ lot.lot_number }}</div>
          <div class="stat-value">
            <div>Total Items: {{ lot.total_items }}</div>
            <div *ngFor="let status of objectKeys(lot.status_breakdown)">
              {{ status }}: {{ lot.status_breakdown[status] }}
            </div>
          </div>
        </mat-card>
      </div>
    </mat-expansion-panel>
  </mat-accordion>

  <!--  Reports & Tally Section -->
  <h3 class="section-heading">Reports & Tally Check</h3>
  <div class="cards">

    <!-- Tally Summary -->
    <mat-card class="stat-card">
      <div class="stat-title">Tally Summary</div>
      <div class="stat-value small">
        <div>Total Assets: {{ tally?.totalAssets }}</div>
        <div>Lot Sum: {{ tally?.lotSum }}</div>
        <div *ngIf="tally?.balanced; else mismatch">âœ… Balanced</div>
        <ng-template #mismatch>âš ï¸ Mismatch Found</ng-template>
      </div>
    </mat-card>

    <!-- Download Reports -->
    <mat-card class="stat-card">
      <div class="stat-title">Download Reports</div>
      <div class="stat-value small">
        <label>From:</label>
        <input type="month" [(ngModel)]="fromMonth" />
        <label>To:</label>
        <input type="month" [(ngModel)]="toMonth" />
        <button mat-raised-button color="primary" (click)="downloadStock()">ğŸ“¦ Stock</button>
        <button mat-raised-button color="accent" (click)="downloadLedger()">ğŸ§¾ Ledger</button>
        <button mat-raised-button color="warn" (click)="downloadReorder()">ğŸ“‰ Reorder Level</button>
        <button mat-raised-button color="success" (click)="downloadAgeAnalysis()">ğŸ•’ Age Analysis</button>
      </div>
    </mat-card>


  </div>
</div>