<mat-card class="main-card">
  <mat-card-title>Employee Details</mat-card-title>

  <!-- unified filter bar (same look as History / Live) -->
  <div class="search-container filter-card">
    <mat-form-field appearance="outline" class="filter-field">
      <mat-label>Search Employees</mat-label>
      <input
        matInput
        [(ngModel)]="searchText"
        (input)="applyFilter()"
        placeholder="Search by Name / Email / Emp Code / PSD ID"
      />
      <button
        *ngIf="searchText"
        matSuffix
        mat-icon-button
        (click)="searchText = ''; applyFilter();"
        aria-label="Clear search"
      >
        <mat-icon>close</mat-icon>
      </button>
    </mat-form-field>

    <mat-form-field appearance="outline" class="filter-field">
      <mat-label>Role</mat-label>
      <mat-select [(ngModel)]="roleFilter" (selectionChange)="applyFilter()">
        <mat-option value="">All</mat-option>
        <mat-option value="IT">IT</mat-option>
        <mat-option value="Manager">Manager</mat-option>
        <mat-option value="Employee">Employee</mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field appearance="outline" class="filter-field">
      <mat-label>Status</mat-label>
      <mat-select [(ngModel)]="statusFilter" (selectionChange)="applyFilter()">
        <mat-option value="">All</mat-option>
        <mat-option value="active">Active</mat-option>
        <mat-option value="inactive">Inactive</mat-option>
      </mat-select>
    </mat-form-field>

    <div class="filter-actions">
      <button mat-stroked-button color="warn" (click)="resetFilters()" aria-label="Reset filters">
        <mat-icon>refresh</mat-icon>
        Reset
      </button>
    </div>
  </div>

  <!-- table (keeps same visual language as other pages) -->
  <div class="table-container">
    <table mat-table [dataSource]="filteredData | filter: searchText: ['name', 'email', 'emp_code']" class="full-width-table">
      <!-- Employee Code -->
      <ng-container matColumnDef="emp_code">
        <th mat-header-cell *matHeaderCellDef> Employee ID </th>
        <td mat-cell *matCellDef="let element">
          <a [routerLink]="['/employees', element.emp_code, 'assignments']" class="emp-link">
            {{ element.emp_code }}
          </a>
        </td>
      </ng-container>

      <!-- Name -->
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef> Name </th>
        <td mat-cell *matCellDef="let element"> {{ element.name }} </td>
      </ng-container>

      <!-- Email -->
      <ng-container matColumnDef="email">
        <th mat-header-cell *matHeaderCellDef> Email </th>
        <td mat-cell *matCellDef="let element"> {{ element.email }} </td>
      </ng-container>

      <!-- Role -->
      <ng-container matColumnDef="role">
        <th mat-header-cell *matHeaderCellDef> Role </th>
        <td mat-cell *matCellDef="let element">
          <span class="role-badge" [ngClass]="{
            'it-role': element.role === 'IT',
            'manager-role': element.role === 'Manager',
            'employee-role': element.role === 'Employee'
          }">
            {{ element.role || 'Employee' }}
          </span>
        </td>
      </ng-container>

      <!-- Status -->
      <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef> Status </th>
        <td mat-cell *matCellDef="let element">
          <span [ngClass]="{
            'active-status': element.status === 'active',
            'inactive-status': element.status === 'inactive'
          }">
            {{ element.status === 'active' ? 'Active' : 'Inactive' }}
          </span>
        </td>
      </ng-container>

      <!-- Actions -->
      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef> Actions </th>
        <td mat-cell *matCellDef="let element">
          <button mat-icon-button color="primary" [routerLink]="['/employees/edit', element.emp_code]" *ngIf="authService.isIT()" matTooltip="Edit Employee">
            <mat-icon>edit</mat-icon>
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns" class="custom-row"></tr>
    </table>
  </div>
</mat-card>
